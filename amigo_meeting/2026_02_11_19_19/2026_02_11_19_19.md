# 3 Amigos Meeting Notes — 首頁登入按鈕

> **Date**: 2026-02-11
> **Requirement Source**: 「在首頁的右上角增加一個名為登入的按鈕」

---

## 0. 原始需求

在首頁的右上角增加一個名為「登入」的按鈕。

---

## 1. Product Owner 分析

### 💭 思考過程

拿到這個需求時，我的第一反應是：「登入按鈕」看起來簡單，但它其實是一個**用戶認證流程的入口**。我需要釐清——這顆按鈕按下去之後會發生什麼事？是跳轉到登入頁面？彈出 Modal？還是導向第三方 OAuth？

接著我思考使用者角色——誰會看到這顆按鈕？未登入的訪客。那已經登入的用戶呢？按鈕應該消失還是變成其他東西（例如頭像 / 登出）？

由於需求明確說「只做這個按鈕」，我會把範圍限縮在按鈕本身的顯示與點擊行為，登入流程的完整實作留給後續的 3 Amigos。但我仍然需要定義按鈕按下去之後的最小行為，否則開發無法進行。

### 1.1 釐清問題與假設

**問題**（由假設回答，因使用者未指定）：

1. 按鈕點擊後導向哪裡？→ 假設：跳轉至 `/login` 登入頁面
2. 已登入用戶是否仍看到此按鈕？→ 假設：已登入用戶不顯示「登入」按鈕（改顯示用戶頭像或名稱，但此次不實作）
3. 按鈕的視覺樣式？→ 假設：遵循現有設計系統，文字型按鈕或 outlined 按鈕，不需額外設計稿
4. 是否需要支援手機版 RWD？→ 假設：需要，按鈕在行動裝置上仍可見可點擊

**關鍵假設：**
- 目前首頁已存在 Header / Navbar 元件
- 登入頁面 (`/login`) 的實作不在本次範圍內，但路由需存在（可先導向空白頁或 placeholder）
- 本次範圍僅包含按鈕的顯示與跳轉，不包含登入表單、認證邏輯

### 1.2 Epic / Feature 拆解

**Epic**: 用戶認證系統
- **Feature 1**: 首頁登入入口（← 本次範圍）
- Feature 2: 登入頁面與表單（未來）
- Feature 3: 認證邏輯與 Session 管理（未來）

### 1.3 User Stories

#### Story 1: 顯示登入按鈕
> **As a** 未登入的訪客，**I want** 在首頁右上角看到一個「登入」按鈕，**so that** 我能清楚知道在哪裡開始登入流程。

**INVEST Check**: ✅ Independent | ✅ Negotiable | ✅ Valuable | ✅ Estimable | ✅ Small | ✅ Testable

#### Story 2: 點擊登入按鈕跳轉
> **As a** 未登入的訪客，**I want** 點擊「登入」按鈕後被導向登入頁面，**so that** 我可以進行登入操作。

**INVEST Check**: ✅ Independent | ✅ Negotiable | ✅ Valuable | ✅ Estimable | ✅ Small | ✅ Testable

### 1.4 Acceptance Criteria

**Story 1: 顯示登入按鈕**
```gherkin
Scenario: 未登入訪客看到登入按鈕
  Given 使用者尚未登入
  When 使用者進入首頁
  Then 首頁右上角（Header 區域）顯示一個文字為「登入」的按鈕

Scenario: 已登入用戶不顯示登入按鈕
  Given 使用者已經登入
  When 使用者進入首頁
  Then 首頁右上角不顯示「登入」按鈕
```

**Story 2: 點擊登入按鈕跳轉**
```gherkin
Scenario: 點擊登入按鈕跳轉至登入頁面
  Given 使用者尚未登入且位於首頁
  When 使用者點擊右上角的「登入」按鈕
  Then 頁面導向 /login 路由

Scenario: 鍵盤操作可觸發按鈕
  Given 使用者尚未登入且位於首頁
  When 使用者用 Tab 鍵聚焦到「登入」按鈕並按下 Enter
  Then 頁面導向 /login 路由
```

### 1.5 優先級（MoSCoW）

| 優先級 | Story | 理由 |
|--------|-------|------|
| **Must** | Story 1: 顯示登入按鈕 | 沒有按鈕就沒有入口，是最基本的功能 |
| **Must** | Story 2: 點擊跳轉 | 按鈕沒有行為等於裝飾，必須能跳轉 |

---

## 2. Frontend Engineer 分析

### 💭 思考過程

拿到 User Story 後，我先看「在首頁右上角」——這意味著要改的是 Header/Navbar 元件，不是頁面主體。

接著我想：這顆按鈕需要根據登入狀態做條件渲染。那我需要知道「使用者是否已登入」這個狀態從哪來？如果目前還沒有認證系統，我需要先預留一個 `isAuthenticated` 狀態，初始值為 `false`，未來接上真正的認證邏輯。

點擊行為是路由跳轉到 `/login`，這很單純——用 `<Link>` 或 `router.push` 即可，不需要 API 呼叫。

最後我確認 RWD——按鈕在手機版也要可見。如果 Header 有漢堡選單，登入按鈕應該在選單內還是始終外露？假設始終外露，因為登入是高優先級的 CTA。

### 2.1 UI/UX 拆解

**Pages / Views：**
- 首頁（現有）：修改 Header 區域

**Components：**

| Component | 類型 | 說明 |
|-----------|------|------|
| `LoginButton` | **新建** | 「登入」按鈕，包含條件渲染邏輯（未登入時顯示）與跳轉行為 |
| `Header` / `Navbar` | **修改** | 在右側區域加入 `LoginButton` |

**User Flow：**
1. 訪客打開首頁
2. 看到右上角「登入」按鈕
3. 點擊按鈕
4. 跳轉至 `/login`

### 2.2 State Management

| State | Scope | Source | Triggers |
|-------|-------|--------|----------|
| `isAuthenticated` | Global (Context/Store) | 未來由 Auth API 提供，目前預設 `false` | 登入/登出行為 |

### 2.3 API Contract 期望

本次不需要 API 呼叫。按鈕行為純粹是前端路由跳轉。

> 未來若需判斷登入狀態，會需要類似 `GET /api/auth/me` 的端點，但不在本次範圍。

### 2.4 Task Breakdown

| # | Task | Story | Estimate |
|---|------|-------|----------|
| FE-1 | 建立 `LoginButton` 元件（按鈕文字「登入」、點擊跳轉 `/login`、`aria-label` 無障礙屬性） | Story 1, 2 | S |
| FE-2 | 修改 `Header`/`Navbar` 元件，在右側區域加入 `LoginButton` | Story 1 | S |
| FE-3 | 加入條件渲染邏輯：根據 `isAuthenticated` 狀態決定是否顯示（先 hardcode `false`） | Story 1 | S |
| FE-4 | 確保 RWD：按鈕在行動裝置上可見且可點擊 | Story 1 | S |
| FE-5 | 確認 `/login` 路由存在（若不存在，建立 placeholder 頁面） | Story 2 | S |

---

## 3. Backend Engineer 分析

### 💭 思考過程

收到 User Story 和前端的分析後，我檢視了需求——這是一個純前端的 UI 變更：新增按鈕 + 路由跳轉。

從後端角度看，**本次不需要任何後端工作**。沒有新的 API、沒有資料庫變更、沒有商業邏輯。

但作為後端工程師，我會預先思考**下一步**：當登入頁面真正需要實作時，會需要什麼？認證端點（`POST /api/auth/login`）、使用者資料表、Session 或 JWT 管理。這些我先記錄為未來工作，不在本次實作。

唯一可能的灰色地帶是：前端提到未來需要 `GET /api/auth/me` 來判斷登入狀態。如果團隊想提前準備，我可以做一個回傳 `{ authenticated: false }` 的 stub endpoint，但這不是 Must-have。

### 3.1 API Design

**本次無需新增 API。**

> 備註（未來參考）：

| Endpoint | Method | 說明 | 時機 |
|----------|--------|------|------|
| `/api/auth/me` | GET | 回傳當前登入狀態與用戶資訊 | 當實作認證功能時 |
| `/api/auth/login` | POST | 登入驗證 | 當實作登入表單時 |

### 3.2 Data Model / Database Changes

**本次無需資料庫變更。**

### 3.3 Business Logic & Service Layer

**本次無需後端商業邏輯。**

### 3.4 Task Breakdown

| # | Task | Story | Estimate |
|---|------|-------|----------|
| BE-1 | （無後端工作）— 可選：建立 `GET /api/auth/me` stub endpoint 回傳 `{ authenticated: false }` | — | S（可選） |

---

## 4. Test Engineer 分析

### 💭 思考過程

拿到 AC 後，我先列出所有場景：登入按鈕顯示、不顯示（已登入時）、點擊跳轉、鍵盤操作。總共 4 個 Gherkin scenario。

接著我想邊界情況：按鈕在不同螢幕尺寸下的可見性？多次快速點擊？瀏覽器的前進/後退行為？

關於手動 vs. 自動化的決策：這是一個簡單的 UI 元素，自動化 ROI 很高——按鈕的存在性檢查和跳轉驗證用 Playwright 可以在幾分鐘內寫完，且未來每次回歸都能跑。手動測試則聚焦在視覺確認（位置、樣式、RWD）這些自動化不容易覆蓋的部分。

風險最高的地方是條件渲染邏輯——如果 `isAuthenticated` 狀態有 bug，按鈕可能在不該出現時出現，或該出現時消失。

### 4.1 Test Strategy Overview

- **Scope**: 首頁 Header 區域的「登入」按鈕——顯示邏輯、點擊行為、無障礙、RWD
- **Approach**: AC 驅動 + 風險導向（條件渲染是最高風險區域）
- **Environments**: Desktop Chrome、Mobile viewport（375px）

### 4.2 Manual Test Cases

| ID | Title | 前置條件 | 步驟 | 預期結果 | 優先級 |
|----|-------|----------|------|----------|--------|
| TC-01 | 登入按鈕顯示在正確位置 | 使用者未登入 | 1. 開啟首頁 2. 查看 Header 右上角 | 按鈕顯示文字「登入」，位於 Header 最右側區域 | High |
| TC-02 | 登入按鈕視覺樣式正確 | 使用者未登入 | 1. 開啟首頁 2. 目視檢查按鈕樣式 | 按鈕樣式與設計系統一致（字型、顏色、間距） | Med |
| TC-03 | 行動裝置上按鈕可見 | 使用者未登入、手機裝置 | 1. 用手機瀏覽器開啟首頁 2. 查看 Header | 按鈕可見、可點擊、不被截斷 | High |
| TC-04 | 點擊按鈕跳轉到登入頁 | 使用者未登入、位於首頁 | 1. 點擊「登入」按鈕 | 頁面跳轉至 `/login`，URL 更新 | High |
| TC-05 | 鍵盤可操作按鈕 | 使用者未登入、位於首頁 | 1. 按 Tab 聚焦到「登入」按鈕 2. 按 Enter | 按鈕有 focus 樣式；按 Enter 後跳轉至 `/login` | Med |
| TC-06 | 已登入用戶不顯示按鈕 | 使用者已登入 | 1. 開啟首頁 2. 查看 Header 右上角 | 不顯示「登入」按鈕 | High |

### 4.3 Automation Test Plan

**建議自動化：**
- TC-01（按鈕存在性）：E2E 基礎 smoke test，每次部署必跑
- TC-04（點擊跳轉）：驗證路由行為，回歸成本低
- TC-05（鍵盤操作）：無障礙自動化
- TC-06（條件渲染）：最高風險區域，必須自動化

**建議保持手動：**
- TC-02（視覺樣式）：需要人眼判斷是否符合設計系統
- TC-03（行動裝置）：可半自動化（設定 viewport），但實機測試更可靠

**建議測試結構：**
```
tests/
├── e2e/
│   └── login-button.spec.ts
│       ├── test: 未登入訪客看到登入按鈕
│       ├── test: 點擊登入按鈕跳轉至 /login
│       ├── test: 鍵盤 Tab + Enter 可操作
│       └── test: 已登入用戶不顯示登入按鈕
```

### 4.4 Edge Cases & Risk Areas

| # | Edge Case / 風險 | 影響 | 建議測試方式 |
|---|------------------|------|-------------|
| 1 | `isAuthenticated` 狀態延遲載入導致按鈕閃爍（先顯示再消失） | Med | 手動觀察 + E2E 等待策略 |
| 2 | `/login` 路由不存在導致 404 | High | 自動化驗證跳轉後頁面狀態 |
| 3 | 按鈕在極窄螢幕（< 320px）被截斷或溢出 | Low | 手動 RWD 測試 |
| 4 | 快速連續點擊造成多次路由跳轉 | Low | 手動快速點擊測試 |

---

## 5. 跨角色依賴與風險

### 5.1 FE ↔ BE API Contract 對齊

| FE 期望 | BE 提供 | 狀態 |
|---------|---------|------|
| 本次無 API 需求 | 本次無 API | ✅ 對齊（無依賴） |
| 未來：`GET /api/auth/me` | 未來實作 | ❓ TBD（下次 3 Amigos 討論） |

### 5.2 Open Questions

1. 已登入用戶的右上角要顯示什麼？（頭像？用戶名？登出按鈕？）— **PO 需定義** — 不影響本次，但影響下一期
2. `/login` 頁面目前是否存在？若不存在，是否接受 placeholder？— **FE 需確認** — 若不存在需額外建立

### 5.3 Technical Risks

| 風險 | 可能性 | 影響 | 緩解措施 |
|------|--------|------|----------|
| 目前沒有 Auth 狀態管理機制，`isAuthenticated` 硬編碼為 `false` | Low | Low | 先 hardcode，未來接入真正的 Auth 時重構 |
| `/login` 路由不存在 | Med | Med | FE-5 任務確保路由存在 |

### 5.4 Suggested Spikes

本次需求簡單，無需 spike。

---

## 6. Action Items 總覽

| 角色 | 任務 | 優先級 | Estimate | 依賴 |
|------|------|--------|----------|------|
| PO | 定義已登入用戶右上角的顯示內容（下一期） | P2 | — | — |
| FE | 建立 `LoginButton` 元件 | P1 | S | — |
| FE | 修改 Header 加入 LoginButton | P1 | S | FE-1 |
| FE | 加入條件渲染邏輯 | P1 | S | FE-2 |
| FE | RWD 確認 | P1 | S | FE-2 |
| FE | 確認 `/login` 路由存在 | P1 | S | — |
| BE | （無工作）可選：stub auth endpoint | P3 | S | — |
| QA | 撰寫 E2E 自動化測試 (`login-button.spec.ts`) | P1 | S | FE 完成 |
| QA | 執行手動測試（視覺樣式 + RWD） | P1 | S | FE 完成 |

---

**下一步建議：**
- 使用 `frontend-engineer` skill 來實作 `LoginButton` 元件與 Header 修改
- 使用 `test-engineer` skill 來生成 Playwright E2E 測試程式碼
- 當要實作登入頁面與認證邏輯時，再開一次 3 Amigos 會議討論完整登入流程
